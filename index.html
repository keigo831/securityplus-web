<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>Security+ SY0-701 題庫</title>
<style>
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans","Helvetica Neue",Arial,sans-serif;font-size:20px;line-height:1.6;padding:24px;max-width:900px;margin:auto;}
button{font-size:20px;padding:8px 16px;margin:4px;}
mark{background:yellow;}
#answer{color:#d32f2f;font-weight:bold;}
</style>
</head>
<body>
<h1>CompTIA Security+ (SY0-701) 題庫</h1>
<p>共 <span id="total"></span> 題。可點「重點」標註題目，系統會記錄於瀏覽器。</p>
<hr>
<h2 id="qnum"></h2>
<div id="question_en"></div>
<div id="question_cn" style="color:#555;margin-bottom:16px;"></div>
<div id="options"></div>
<p><strong>✅ 正確答案：</strong> <span id="answer"></span></p>
<p><strong>🔑 關鍵字：</strong> <span id="keywords"></span></p>
<p><strong>📘 解題說明：</strong> <span id="explanation"></span></p>
<div style="margin-top:24px;">
  <button id="prev">上一題</button>
  <button id="next">下一題</button>
  <button id="bookmark">標註重點</button>
  <button id="showbookmarks">查看重點</button>
</div>
<script>
let data=[], idx=0;
let bookmarks=JSON.parse(localStorage.getItem('bookmarkIds')||'[]');
const tCache={};
function translate(text){
  if(!text) return Promise.resolve('');
  if(tCache[text]) return Promise.resolve(tCache[text]);
  const url='https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=zh-TW&dt=t&q='+encodeURIComponent(text);
  return fetch(url).then(r=>r.json()).then(arr=>{
    const res=arr[0].map(x=>x[0]).join('');
    tCache[text]=res;return res;
  }).catch(()=> '');
}
fetch('questions.json').then(r=>r.json()).then(j=>{
  data=j;
  document.getElementById('total').textContent=data.length;
  load(0);
});
function load(i){
  idx=i;
  const q=data[i];
  document.getElementById('qnum').textContent='Question #'+q.id;
  document.getElementById('question_en').innerHTML=q.question_html;
  translate(q.question).then(txt=>document.getElementById('question_cn').textContent=txt);
  document.getElementById('options').innerHTML=q.options.map(o=>'<div>'+o+'</div>').join('');
  translate(q.correct_text).then(ans_cn=>{
    document.getElementById('answer').textContent=q.correct_letter+'. '+q.correct_text+' / '+ans_cn;
  });
  Promise.all(q.keywords.map(k=>translate(k))).then(arr=>{
    const combined=q.keywords.map((k,i)=>k+'（'+arr[i]+'）').join('、');
    document.getElementById('keywords').textContent=combined;
  });
  document.getElementById('explanation').textContent='待補充';
  document.getElementById('prev').disabled=(idx===0);
  document.getElementById('next').disabled=(idx===data.length-1);
  updateBmBtn();
  window.scrollTo({top:0,behavior:'smooth'});
}
function updateBmBtn(){
  const btn=document.getElementById('bookmark');
  if(bookmarks.includes(data[idx].id)){btn.textContent='已標註';btn.style.background='#ffd54f';}
  else{btn.textContent='標註重點';btn.style.background='';}
}
document.getElementById('prev').onclick=()=>load(idx-1);
document.getElementById('next').onclick=()=>load(idx+1);
document.getElementById('bookmark').onclick=()=>{
  const id=data[idx].id;
  const i=bookmarks.indexOf(id);
  if(i>-1) bookmarks.splice(i,1);
  else bookmarks.push(id);
  localStorage.setItem('bookmarkIds',JSON.stringify(bookmarks));
  updateBmBtn();
};
document.getElementById('showbookmarks').onclick=()=>{
  if(bookmarks.length===0) alert('尚未標註任何題目');
  else alert('已標註題號：'+bookmarks.join(', '));
};
</script>
</body>
</html>